## cAdvisor

#### 介绍：

cAdvisor是kubelet的一部分，运行在每个node节点，它会手机每个容器的信息，比如cpu，memmory，network，文件系统等；

## 使用Heapster监控Kubernetes集群

#### 介绍:

* Heapster是一个Kubernetes的项目，提供了强健的，可靠的监控Kubernetes集群的方式.
* 可以通过Kubernetes管理，通过pod的方式运行。
* Heapster首先从Kubernetes apiserver查询所有Node的信息，然后再从kubelet提供的API采集节点和容器的资源占用。
* Heapster可以将采取到的数据存储在不同的可持久化的存储当中，通过不同的前端工具展示，建议的搭配是InfluxDB和Grafana。
* 有很多别的后端存储工具，比如Log, OpenTSDB, Kafka, Elasticsearch。
* 当然也可以同时使用多个backend去存储采集到的数据。通过--sink配置。


![](https://github.com/oaas/kubernetes/blob/master/chapter6/heapster.png?raw=true)


## InfluxDB

#### 介绍：

InfluxDB是一个时序数据库，非常适合用来收集时间化序列的数据，同时也提供集群功能。

#### Storage Schema:

定义存储的schema，可以用来查询或图形化显示数据；可用的监控指标如下：

每个容器基本的信息如下：

* pod_id:
* pod_name:
* pod_namespace:
* container_base_image:
* host_id:
* hostname:
* labels:
* namespace_id:
* resource_id:

CPU：

* cpu/limit：容器的cpu硬限制
* cpu/node_capcity：node的cpu容量大小
* cpu/node_allocatable: node的空闲的可分配的CPU容量
* cpu/node_reservation: 在可分配节点上保留的CPU的份额
* cpu/node_utilization: node节点的CPU利用率
* cpu/request: 容器的cpu使用量的软限制
* cpu/usage: 整体的cpu用量
* cpu/usage_rate: 整体的CPU使用量通过millicores的方式展示


文件系统：

* filesystem/usage:
* filesystem/limit
* filesystem/available

内存：

* memory/limit
* memory/major_page_faults
* memory/major_page_faults_rate
* memory/node_capacity
* memory/node_allocatable
* memory/node_reservation
* memory/node_utilization
* memory/page_faults
* memory/page_faults_rate
* memory/request
* memory/usage
* memory/working_set

网络：

* network/rx
* network/rx_errors
* network/rx_errors_rate
* network/rx_rate
* network/tx
* network/tx_errors
* network/tx_errors_rate
* network/tx_rate

Uptime:

* uptime 容器运行的时间



